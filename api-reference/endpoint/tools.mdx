---
title: "GET /tools"
description: "获取可用工具及其上下文要求"
---

## 端点

```
GET https://huajune.duliday.com/api/v1/tools
```

## 认证

```http
Authorization: Bearer YOUR_API_KEY
```

## 请求参数

此端点不需要任何参数。

## 响应格式

<ResponseField name="success" type="boolean">
  请求是否成功
</ResponseField>

<ResponseField name="data" type="object">
  响应数据对象

  <Expandable title="data 对象属性">
    <ResponseField name="tools" type="array">
      可用工具数组,每个工具包含以下字段:

      <Expandable title="tool 对象属性">
        <ResponseField name="name" type="string">
          工具名称,用于 `allowedTools` 数组

          示例: `bash`, `zhipin_reply_generator`
        </ResponseField>

        <ResponseField name="requiresSandbox" type="boolean">
          是否需要沙箱环境

          - `true`: 工具在隔离的沙箱中执行
          - `false`: 工具直接执行
        </ResponseField>

        <ResponseField name="requiredContext" type="array">
          工具所需的上下文字段名称数组

          示例: `["configData", "replyPrompts"]`

          这些字段必须在 `context` 或 `toolContext` 中提供
        </ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
</ResponseField>

## 响应示例

```json
{
  "success": true,
  "data": {
    "tools": [
      {
        "name": "bash",
        "requiresSandbox": false,
        "requiredContext": []
      },
      {
        "name": "zhipin_reply_generator",
        "requiresSandbox": false,
        "requiredContext": ["configData", "replyPrompts"]
      }
    ]
  }
}
```

## 内置工具说明

### bash

执行 Bash 命令,适用于文件操作、系统命令等场景。

**所需上下文**: 无

**示例用法**:
```json
{
  "allowedTools": ["bash"],
  "messages": [
    { "role": "user", "content": "查看当前目录" }
  ]
}
```

### zhipin_reply_generator

生成 BOSS 直聘招聘回复,用于自动化候选人沟通。

**所需上下文**:
- `configData`: 品牌配置数据
- `replyPrompts`: 回复提示词配置

**示例用法**:
```json
{
  "allowedTools": ["zhipin_reply_generator"],
  "context": {
    "configData": { ... },
    "replyPrompts": { ... }
  },
  "messages": [
    { "role": "user", "content": "生成一条回复" }
  ]
}
```

## 示例代码

<CodeGroup>

```bash cURL
curl -X GET https://huajune.duliday.com/api/v1/tools \
  -H "Authorization: Bearer YOUR_API_KEY"
```

```javascript JavaScript
const response = await fetch('https://huajune.duliday.com/api/v1/tools', {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${apiKey}`
  }
});

const data = await response.json();
const tools = data.data.tools;

console.log('可用工具:');
tools.forEach(tool => {
  console.log(`- ${tool.name}`);
  if (tool.requiredContext.length > 0) {
    console.log(`  需要上下文: ${tool.requiredContext.join(', ')}`);
  }
});
```

```python Python
import requests

url = 'https://huajune.duliday.com/api/v1/tools'
headers = {
    'Authorization': f'Bearer {api_key}'
}

response = requests.get(url, headers=headers)
data = response.json()
tools = data['data']['tools']

print('可用工具:')
for tool in tools:
    print(f"- {tool['name']}")
    if tool['requiredContext']:
        print(f"  需要上下文: {', '.join(tool['requiredContext'])}")
```

```javascript JavaScript (检查工具可用性)
async function isToolAvailable(toolName) {
  const response = await fetch('https://huajune.duliday.com/api/v1/tools', {
    headers: { 'Authorization': `Bearer ${apiKey}` }
  });
  const data = await response.json();

  return data.data.tools.some(t => t.name === toolName);
}

const available = await isToolAvailable('bash');
console.log('bash 可用:', available);
```

```javascript JavaScript (获取工具上下文要求)
async function getToolRequirements(toolName) {
  const response = await fetch('https://huajune.duliday.com/api/v1/tools', {
    headers: { 'Authorization': `Bearer ${apiKey}` }
  });
  const data = await response.json();

  const tool = data.data.tools.find(t => t.name === toolName);
  return tool ? tool.requiredContext : null;
}

const requirements = await getToolRequirements('zhipin_reply_generator');
console.log('需要的上下文:', requirements);
// 输出: ['configData', 'replyPrompts']
```

</CodeGroup>

## 使用场景

<AccordionGroup>
  <Accordion title="动态工具选择">
    根据用户权限动态展示可用工具:

    ```javascript
    async function getAvailableTools() {
      const response = await fetch('/api/v1/tools', {
        headers: { 'Authorization': `Bearer ${apiKey}` }
      });
      const data = await response.json();
      return data.data.tools;
    }

    // 在 UI 中展示工具选择器
    const tools = await getAvailableTools();
    const toolOptions = tools.map(t => ({
      value: t.name,
      label: t.name,
      requiresContext: t.requiredContext.length > 0
    }));
    ```
  </Accordion>

  <Accordion title="验证上下文完整性">
    在发起请求前验证上下文是否完整:

    ```javascript
    async function validateToolContext(toolName, providedContext) {
      const response = await fetch('/api/v1/tools', {
        headers: { 'Authorization': `Bearer ${apiKey}` }
      });
      const data = await response.json();

      const tool = data.data.tools.find(t => t.name === toolName);
      if (!tool) return { valid: false, error: 'Tool not found' };

      const missing = tool.requiredContext.filter(
        ctx => !(ctx in providedContext)
      );

      return {
        valid: missing.length === 0,
        missing: missing
      };
    }

    const validation = await validateToolContext('zhipin_reply_generator', {
      configData: { ... }
      // 缺少 replyPrompts
    });

    if (!validation.valid) {
      console.error('缺少上下文:', validation.missing);
      // 输出: ['replyPrompts']
    }
    ```
  </Accordion>

  <Accordion title="工具元数据管理">
    构建工具配置管理系统:

    ```javascript
    class ToolManager {
      constructor(apiKey) {
        this.apiKey = apiKey;
        this.tools = null;
      }

      async loadTools() {
        const response = await fetch('/api/v1/tools', {
          headers: { 'Authorization': `Bearer ${this.apiKey}` }
        });
        const data = await response.json();
        this.tools = data.data.tools;
      }

      getToolsByRequirement(hasContext) {
        return this.tools.filter(t =>
          hasContext
            ? t.requiredContext.length > 0
            : t.requiredContext.length === 0
        );
      }

      getRequiredContext(toolName) {
        const tool = this.tools.find(t => t.name === toolName);
        return tool ? tool.requiredContext : [];
      }
    }

    const manager = new ToolManager(apiKey);
    await manager.loadTools();

    // 获取不需要上下文的工具
    const simpleTools = manager.getToolsByRequirement(false);
    ```
  </Accordion>

  <Accordion title="构建上下文提示">
    根据工具要求提示用户提供上下文:

    ```javascript
    async function buildContextPrompt(selectedTools) {
      const response = await fetch('/api/v1/tools', {
        headers: { 'Authorization': `Bearer ${apiKey}` }
      });
      const data = await response.json();

      const allRequiredContext = new Set();

      selectedTools.forEach(toolName => {
        const tool = data.data.tools.find(t => t.name === toolName);
        if (tool) {
          tool.requiredContext.forEach(ctx => allRequiredContext.add(ctx));
        }
      });

      return Array.from(allRequiredContext);
    }

    const required = await buildContextPrompt(['zhipin_reply_generator']);
    console.log('请提供以下上下文:', required);
    // 输出: ['configData', 'replyPrompts']
    ```
  </Accordion>
</AccordionGroup>

## 工具上下文说明

### context vs toolContext

- **`context`**: 全局上下文,所有工具共享
- **`toolContext`**: 工具级上下文,仅特定工具使用,会覆盖 `context` 中的同名字段

示例:
```json
{
  "allowedTools": ["zhipin_reply_generator"],
  "context": {
    "configData": { "brand": "A" },
    "replyPrompts": { "type": "default" }
  },
  "toolContext": {
    "zhipin_reply_generator": {
      "replyPrompts": { "type": "custom" }  // 覆盖 context 中的 replyPrompts
    }
  }
}
```

### contextStrategy

控制缺失上下文时的行为:

| 策略     | 行为                           |
| -------- | ------------------------------ |
| `error`  | 返回 400 错误,列出缺失字段    |
| `skip`   | 跳过无法实例化的工具,继续执行 |
| `report` | 仅返回验证报告,不执行请求     |

详见 [工具调用功能](/features/tool-calling)

## 常见错误

### 401 Unauthorized

```json
{
  "error": "Unauthorized",
  "message": "Invalid or missing API key",
  "statusCode": 401
}
```

**解决方案**: 检查 API Key 是否正确

### 使用工具时的 400 错误

```json
{
  "error": "BadRequest",
  "message": "Missing required context: configData, replyPrompts",
  "details": {
    "missingContext": ["configData", "replyPrompts"],
    "tools": ["zhipin_reply_generator"]
  },
  "statusCode": 400
}
```

**解决方案**:
1. 查询 `/api/v1/tools` 获取工具的 `requiredContext`
2. 在 `context` 或 `toolContext` 中提供缺失字段
3. 或使用 `contextStrategy: "skip"` 跳过该工具

详见 [错误码表](/api-reference/error-codes)

## 最佳实践

<CardGroup cols={2}>
  <Card title="缓存工具列表" icon="database">
    工具列表变化不频繁,建议缓存 1-24 小时
  </Card>

  <Card title="预检验证" icon="check">
    使用 `validateOnly: true` 验证工具配置
  </Card>

  <Card title="上下文管理" icon="gear">
    根据 `requiredContext` 动态构建上下文对象
  </Card>

  <Card title="降级策略" icon="shield">
    使用 `contextStrategy: "skip"` 实现优雅降级
  </Card>
</CardGroup>

## 相关文档

<CardGroup cols={2}>
  <Card
    title="工具系统"
    icon="wrench"
    href="/concepts/tools"
  >
    了解工具系统的核心概念
  </Card>

  <Card
    title="工具调用"
    icon="code"
    href="/features/tool-calling"
  >
    查看完整的工具调用示例
  </Card>

  <Card
    title="上下文管理"
    icon="gear"
    href="/concepts/context"
  >
    深入了解上下文配置
  </Card>

  <Card
    title="Chat API"
    icon="message"
    href="/api-reference/endpoint/chat"
  >
    在对话中使用工具
  </Card>
</CardGroup>
