---
title: "å·¥å…·è°ƒç”¨"
description: "è®© AI è°ƒç”¨å¤–éƒ¨å·¥å…·å®Œæˆå¤æ‚ä»»åŠ¡"
---

## ä»€ä¹ˆæ˜¯å·¥å…·è°ƒç”¨ï¼Ÿ

å·¥å…·è°ƒç”¨å…è®¸ AI æ¨¡å‹æ‰§è¡Œå¤–éƒ¨åŠŸèƒ½ï¼Œå¦‚è¿è¡Œä»£ç ã€æŸ¥è¯¢æ•°æ®åº“ã€ç”Ÿæˆç‰¹å®šæ ¼å¼çš„å†…å®¹ç­‰ã€‚

<Note>
  **é‡è¦**ï¼šèŠ±å·æ™ºèƒ½ä½“ API é‡‡ç”¨**æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œ**æ¨¡å¼ï¼Œä¸€æ¬¡è¯·æ±‚å³å¯å®Œæˆå·¥å…·è°ƒç”¨å’Œç»“æœå¤„ç†ï¼Œæ— éœ€å®¢æˆ·ç«¯å¤šè½®äº¤äº’ã€‚
</Note>

## å·¥å…·è°ƒç”¨æµç¨‹

èŠ±å·æ™ºèƒ½ä½“ API åœ¨æœåŠ¡ç«¯è‡ªåŠ¨å®Œæˆå·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹ï¼š

<Steps>
  <Step title="1. ç”¨æˆ·å‘èµ·è¯·æ±‚">
    ç”¨æˆ·å‘é€å•æ¬¡è¯·æ±‚ï¼ŒåŒ…å« `allowedTools` å‚æ•°å’Œå¿…è¦çš„ä¸Šä¸‹æ–‡ï¼š

    ```json ç”¨æˆ·è¯·æ±‚ lines icon="paper-plane"
    {
      "model": "anthropic/claude-3-7-sonnet-20250219",
      "messages": [
        {
          "role": "user",
          "content": "å€™é€‰äººé—®ï¼šä½ ä»¬å…¬å¸åœ°å€åœ¨å“ªï¼Ÿ"
        }
      ],
      "allowedTools": ["zhipin_reply_generator"],
      "context": {
        "preferredBrand": "èœ€åœ°æºå†’èœ",
        "configData": {
          "city": "ä¸Šæµ·",
          "brands": {
            "èœ€åœ°æºå†’èœ": {
              "address": "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºXXè·¯XXå·"
            }
          }
        },
        "replyPrompts": {
          "location_inquiry": "å‹å¥½åœ°å‘ŠçŸ¥å…¬å¸åœ°å€ï¼Œå¹¶è¯¢é—®æ˜¯å¦éœ€è¦è·¯çº¿æŒ‡å¼•"
        }
      }
    }
    ```
  </Step>

  <Step title="2. æœåŠ¡ç«¯è‡ªåŠ¨å¤„ç†">
    æœåŠ¡ç«¯åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

    1. **AI å†³å®š**éœ€è¦è°ƒç”¨å·¥å…·
    2. **æœåŠ¡ç«¯æ‰§è¡Œ**å·¥å…·ï¼ˆzhipin_reply_generator ç­‰ï¼‰
    3. **AI ç†è§£**æ‰§è¡Œç»“æœ
    4. **ç”Ÿæˆæœ€ç»ˆ**å›å¤

    <Note>
      æ‰€æœ‰å·¥å…·è°ƒç”¨éƒ½åœ¨æœåŠ¡ç«¯è‡ªåŠ¨å®Œæˆï¼Œæœ€å¤šå¯æ‰§è¡Œ 30 æ­¥ï¼ˆåŒ…æ‹¬å¤šæ¬¡å·¥å…·è°ƒç”¨ï¼‰ã€‚
    </Note>
  </Step>

  <Step title="3. è¿”å›å®Œæ•´å¯¹è¯å†å²">
    API è¿”å›åŒ…å«æ‰€æœ‰ä¸­é—´æ­¥éª¤çš„å®Œæ•´å¯¹è¯å†å²ï¼š

    ```json API å“åº” lines expandable highlight={7-23} icon="check-circle"
    {
      "success": true,
      "data": {
        "messages": [
          {
            "id": "msg_001",
            "role": "assistant",
            "parts": [
              {
                "type": "dynamic-tool",
                "toolName": "zhipin_reply_generator",
                "toolCallId": "call_abc123",
                "state": "output-available",
                "input": {
                  "candidate_message": "ä½ ä»¬å…¬å¸åœ°å€åœ¨å“ªï¼Ÿ",
                  "brand": "èœ€åœ°æºå†’èœ"
                },
                "output": {
                  "reply": "æ‚¨å¥½ï¼æˆ‘ä»¬èœ€åœ°æºå†’èœä½äºä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºXXè·¯XXå·ï¼Œäº¤é€šä¾¿åˆ©ã€‚å¦‚æœæ‚¨éœ€è¦è¯¦ç»†çš„è·¯çº¿æŒ‡å¼•ï¼Œæˆ‘å¾ˆä¹æ„ä¸ºæ‚¨æä¾›ã€‚æœŸå¾…ä¸æ‚¨çš„é¢è°ˆï¼ğŸ˜Š"
                }
              }
            ]
          },
          {
            "id": "msg_002",
            "role": "assistant",
            "parts": [
              {
                "type": "text",
                "text": "å·²ä¸ºæ‚¨ç”Ÿæˆä¸“ä¸šçš„å›å¤ï¼Œå†…å®¹åŒ…å«äº†å…¬å¸åœ°å€ä¿¡æ¯ï¼Œå¹¶ä¸»åŠ¨è¯¢é—®å€™é€‰äººæ˜¯å¦éœ€è¦è·¯çº¿æŒ‡å¼•ã€‚",
                "state": "done"
              }
            ]
          }
        ],
        "usage": {
          "inputTokens": 280,
          "outputTokens": 120,
          "totalTokens": 400
        },
        "tools": {
          "used": ["zhipin_reply_generator"],
          "skipped": []
        }
      }
    }
    ```

    <Tip>
      å“åº”ä¸­çš„ `messages` æ•°ç»„åŒ…å«å®Œæ•´çš„æ‰§è¡Œå†å²ï¼ŒåŒ…æ‹¬å·¥å…·è°ƒç”¨çš„è¾“å…¥å’Œè¾“å‡ºã€‚
    </Tip>
  </Step>
</Steps>

## dynamic-tool ç»“æ„è¯´æ˜

å·¥å…·è°ƒç”¨ä½¿ç”¨ `dynamic-tool` ç±»å‹çš„ partï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `type` | `string` | å›ºå®šå€¼ `"dynamic-tool"` |
| `toolName` | `string` | å·¥å…·åç§°ï¼ˆå¦‚ `zhipin_reply_generator`ï¼‰ |
| `toolCallId` | `string` | AI ç”Ÿæˆçš„å”¯ä¸€è°ƒç”¨ ID |
| `state` | `string` | å·¥å…·çŠ¶æ€ï¼š`"output-available"`ï¼ˆå·²å®Œæˆï¼‰æˆ– `"input-available"`ï¼ˆä»…è¾“å…¥ï¼‰ |
| `input` | `object` | å·¥å…·è¾“å…¥å‚æ•°ï¼ˆä½¿ç”¨ snake_case å‘½åï¼‰ |
| `output` | `object` | å·¥å…·è¾“å‡ºç»“æœï¼ˆä»…å½“ `state: "output-available"` æ—¶å­˜åœ¨ï¼‰ |

<Note>
  æ‰€æœ‰å·¥å…·è¾“å…¥å‚æ•°ä½¿ç”¨ **snake_case** å‘½åçº¦å®šï¼ˆå¦‚ `candidate_message`ï¼‰ï¼Œè€Œé camelCaseã€‚
</Note>

## æµç¨‹å¯¹æ¯”

<Tabs>
  <Tab title="æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œï¼ˆèŠ±å·æ™ºèƒ½ä½“ APIï¼‰">
    **å½“å‰é‡‡ç”¨çš„æ¨¡å¼**ï¼š

    ```
    ç”¨æˆ· â†’ API (ä¸€æ¬¡è¯·æ±‚)
        â†“
    1. AI å†³å®šéœ€è¦è°ƒç”¨å·¥å…·
        â†“
    2. æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œå·¥å…·
        â†“
    3. AI ç†è§£å·¥å…·ç»“æœ
        â†“
    4. ç”Ÿæˆæœ€ç»ˆå›å¤
        â†“
    API â†’ ç”¨æˆ· (å®Œæ•´çš„å¯¹è¯å†å²)
    ```

    **ä¼˜ç‚¹**ï¼š
    - âœ… å•æ¬¡è¯·æ±‚å®Œæˆ
    - âœ… æ— éœ€å®¢æˆ·ç«¯å¤„ç†å·¥å…·æ‰§è¡Œ
    - âœ… è‡ªåŠ¨é‡è¯•å’Œé”™è¯¯å¤„ç†
    - âœ… å®Œæ•´çš„æ‰§è¡Œå†å²

    **é€‚ç”¨åœºæ™¯**ï¼š
    - æœåŠ¡ç«¯å¯ä»¥å®‰å…¨æ‰§è¡Œçš„å·¥å…·ï¼ˆbashã€æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼‰
    - ä¸éœ€è¦ç”¨æˆ·äº¤äº’çš„è‡ªåŠ¨åŒ–ä»»åŠ¡
  </Tab>

  <Tab title="å®¢æˆ·ç«¯æ‰§è¡Œï¼ˆå…¶ä»– API å¸¸è§æ¨¡å¼ï¼‰">
    **æ³¨æ„**ï¼šèŠ±å·æ™ºèƒ½ä½“ API **ä¸é‡‡ç”¨**è¿™ç§æ¨¡å¼

    ```
    ç”¨æˆ· â†’ API (è¯·æ±‚ 1)
        â†“
    API â†’ ç”¨æˆ· (è¿”å› tool-call)
        â†“
    ç”¨æˆ·æ‰§è¡Œå·¥å…·
        â†“
    ç”¨æˆ· â†’ API (è¯·æ±‚ 2, æäº¤ tool-result)
        â†“
    API â†’ ç”¨æˆ· (æœ€ç»ˆç»“æœ)
    ```

    **ç‰¹ç‚¹**ï¼š
    - éœ€è¦å¤šè½®è¯·æ±‚
    - å®¢æˆ·ç«¯è´Ÿè´£å·¥å…·æ‰§è¡Œ
    - é€‚åˆéœ€è¦ç”¨æˆ·ç¡®è®¤çš„åœºæ™¯
  </Tab>
</Tabs>

## åŸºç¡€ç”¨æ³•

### ç®€å•ç¤ºä¾‹

é€šè¿‡ `allowedTools` æ•°ç»„å¯ç”¨å·¥å…·ï¼š

```json åŸºç¡€å·¥å…·è°ƒç”¨ lines icon="screwdriver-wrench"
{
  "model": "anthropic/claude-3-7-sonnet-20250219",
  "messages": [
    {
      "role": "user",
      "content": "å€™é€‰äººé—®ï¼šä½ ä»¬è–ªèµ„å¾…é‡æ€ä¹ˆæ ·ï¼Ÿ"
    }
  ],
  "allowedTools": ["zhipin_reply_generator"],
  "context": {
    "preferredBrand": "èœ€åœ°æºå†’èœ",
    "configData": {
      "city": "ä¸Šæµ·",
      "brands": {
        "èœ€åœ°æºå†’èœ": {
          "templates": {
            "salary_inquiry": ["åŸºæœ¬å·¥èµ„4000-6000å…ƒï¼Œå¦æœ‰å…¨å‹¤å¥–ã€ç»©æ•ˆå¥–ç­‰"]
          }
        }
      }
    },
    "replyPrompts": {
      "salary_inquiry": "ç”¨ç¤¼è²Œçš„è¯­æ°”è¯´æ˜è–ªèµ„å¾…é‡ï¼Œé¿å…æ‰¿è¯ºæ— æ³•å…‘ç°çš„æ¡ä»¶"
    }
  }
}
```

<Note>
  å“åº”åŒ…å«å®Œæ•´çš„æ‰§è¡Œè¿‡ç¨‹ï¼ŒåŒ…æ‹¬å·¥å…·è°ƒç”¨å’Œæ™ºèƒ½ç”Ÿæˆçš„å›å¤ã€‚
</Note>

### å¤šè½®å¯¹è¯åœºæ™¯

AI å¯ä»¥åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ç†è§£ä¸Šä¸‹æ–‡å¹¶è°ƒç”¨å·¥å…·ï¼š

```json å¤šè½®å¯¹è¯ç¤ºä¾‹ lines expandable icon="comments"
{
  "model": "anthropic/claude-3-7-sonnet-20250219",
  "messages": [
    {
      "role": "user",
      "content": "å€™é€‰äººè¯´ï¼šå·¥èµ„èƒ½è°ˆå—ï¼Ÿ"
    },
    {
      "role": "assistant",
      "content": "å½“ç„¶å¯ä»¥ï¼Œæˆ‘ä»¬çš„è–ªèµ„èŒƒå›´æ˜¯4000-6000å…ƒã€‚"
    },
    {
      "role": "user",
      "content": "å€™é€‰äººåˆé—®ï¼šé‚£æœ‰äº”é™©ä¸€é‡‘å—ï¼Ÿ"
    }
  ],
  "allowedTools": ["zhipin_reply_generator"],
  "context": {
    "preferredBrand": "èœ€åœ°æºå†’èœ",
    "configData": {
      "brands": {
        "èœ€åœ°æºå†’èœ": {
          "benefits": "äº”é™©ä¸€é‡‘ã€å‘˜å·¥é¤ã€äº¤é€šè¡¥è´´"
        }
      }
    }
  }
}
```

<Tip>
  æœåŠ¡ç«¯ä¼šæ ¹æ®å¯¹è¯å†å²å’Œä¸Šä¸‹æ–‡ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ‹›è˜å›å¤ã€‚
</Tip>

## å¯ç”¨å·¥å…·

ä½¿ç”¨ `GET /api/v1/tools` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å·¥å…·åŠå…¶é…ç½®è¦æ±‚ã€‚

### Bash å·¥å…·

æ‰§è¡Œ Bash å‘½ä»¤ï¼Œ**éœ€è¦ E2B æ²™ç›’ç¯å¢ƒ**ï¼š

<Warning>
  **é‡è¦**ï¼šbash å·¥å…·éœ€è¦åœ¨æ²™ç›’ç¯å¢ƒä¸­è¿è¡Œã€‚ä½¿ç”¨å‰éœ€è¦ï¼š
  1. åˆ›å»º E2B æ²™ç›’å®¢æˆ·ç«¯
  2. åœ¨ `context` ä¸­æä¾› `sandboxId`

  å¦‚æœæ²¡æœ‰æ²™ç›’ç¯å¢ƒï¼Œå·¥å…·å°†æ— æ³•å·¥ä½œã€‚
</Warning>

```javascript Bash å·¥å…·ç¤ºä¾‹ï¼ˆéœ€è¦æ²™ç›’ï¼‰ lines expandable icon="terminal"
const response = await fetch("https://huajune.duliday.com/api/v1/chat", {
  method: "POST",
  headers: {
    Authorization: `Bearer ${apiKey}`,
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    model: "anthropic/claude-3-7-sonnet-20250219",
    messages: [{ role: "user", content: "æ£€æŸ¥ç³»ç»Ÿç£ç›˜ä½¿ç”¨æƒ…å†µ" }],
    allowedTools: ["bash"],
    context: {
      sandboxId: "your_e2b_sandbox_id"  // â† å¿…éœ€ï¼šE2B æ²™ç›’ ID
    }
  }),
});

const data = await response.json();
console.log("å®Œæ•´å¯¹è¯å†å²:", data.messages);
```

<Note>
  **æ¨è**ï¼šå¯¹äºä¸€èˆ¬çš„ä¸šåŠ¡åœºæ™¯ï¼Œå»ºè®®ä½¿ç”¨ `zhipin_reply_generator` ç­‰ä¸šåŠ¡å·¥å…·ï¼Œè€Œé bash å·¥å…·ã€‚
</Note>

### zhipin_reply_generator å·¥å…·

ç”Ÿæˆ BOSS ç›´è˜æ‹›è˜å›å¤ï¼Œéœ€è¦ `configData` å’Œ `replyPrompts` ä¸Šä¸‹æ–‡ï¼š

```json æ‹›è˜å›å¤ç”Ÿæˆå·¥å…· lines expandable icon="message-bot"
{
  "model": "anthropic/claude-3-7-sonnet-20250219",
  "messages": [
    {
      "role": "user",
      "content": "å€™é€‰äººé—®ï¼šä½ ä»¬å·¥èµ„å¤šå°‘ï¼Ÿ"
    }
  ],
  "allowedTools": ["zhipin_reply_generator"],
  "context": {
    "preferredBrand": "èœ€åœ°æºå†’èœ",
    "configData": {
      "city": "ä¸Šæµ·",
      "brands": {
        "èœ€åœ°æºå†’èœ": {
          "templates": {
            "salary_inquiry": ["åŸºæœ¬å·¥èµ„4000-6000å…ƒï¼Œå¦æœ‰å…¨å‹¤å¥–ã€ç»©æ•ˆå¥–ç­‰"]
          }
        }
      }
    },
    "replyPrompts": {
      "salary_inquiry": "ç”¨ç¤¼è²Œçš„è¯­æ°”è¯´æ˜è–ªèµ„å¾…é‡ï¼Œé¿å…æ‰¿è¯ºæ— æ³•å…‘ç°çš„æ¡ä»¶"
    }
  }
}
```

## å·¥å…·ä¸Šä¸‹æ–‡

æŸäº›å·¥å…·éœ€è¦é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š

<AccordionGroup>
  <Accordion title="å…¨å±€ä¸Šä¸‹æ–‡ - context" icon="globe">
    ä½¿ç”¨ `context` æä¾›æ‰€æœ‰å·¥å…·å…±äº«çš„ä¸Šä¸‹æ–‡ï¼š

    ```json å…¨å±€ä¸Šä¸‹æ–‡ lines icon="globe"
    {
      "allowedTools": ["zhipin_reply_generator"],
      "context": {
        "configData": { ... },
        "replyPrompts": { ... },
        "preferredBrand": "èœ€åœ°æºå†’èœ"
      }
    }
    ```
  </Accordion>

  <Accordion title="å·¥å…·çº§ä¸Šä¸‹æ–‡ - toolContext" icon="layer-group">
    ä½¿ç”¨ `toolContext` ä¸ºç‰¹å®šå·¥å…·æä¾›ä¸Šä¸‹æ–‡ï¼Œä¼šè¦†ç›–å…¨å±€ `context`ï¼š

    ```json å·¥å…·çº§ä¸Šä¸‹æ–‡ lines icon="layer-group"
    {
      "allowedTools": ["zhipin_reply_generator"],
      "context": {
        "replyPrompts": { "default": "é»˜è®¤æ¨¡æ¿" }
      },
      "toolContext": {
        "zhipin_reply_generator": {
          "replyPrompts": {
            "general_chat": "è‡ªå®šä¹‰å›å¤æ¨¡æ¿"  // ä¼šè¦†ç›–å…¨å±€é…ç½®
          }
        }
      }
    }
    ```
  </Accordion>
</AccordionGroup>

è¯¦è§[ä¸Šä¸‹æ–‡ç®¡ç†æ–‡æ¡£](/concepts/context)

## ä¸Šä¸‹æ–‡ç­–ç•¥

æ§åˆ¶å·¥å…·ä¸Šä¸‹æ–‡ç¼ºå¤±æ—¶çš„è¡Œä¸ºï¼š

<Tabs>
  <Tab title="errorï¼ˆé»˜è®¤ï¼‰">
    ç¼ºå°‘å¿…éœ€ä¸Šä¸‹æ–‡æ—¶è¿”å› 400 é”™è¯¯ï¼š

    ```json é”™è¯¯å“åº” lines highlight={2-6} icon="triangle-exclamation"
    {
      "error": "BadRequest",
      "message": "Missing required context: configData, replyPrompts",
      "details": {
        "missingContext": ["configData", "replyPrompts"],
        "tools": ["zhipin_reply_generator"]
      },
      "statusCode": 400
    }
    ```

    **é€‚ç”¨åœºæ™¯**ï¼šç¡®ä¿å·¥å…·é…ç½®æ­£ç¡®ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
  </Tab>

  <Tab title="skip">
    è·³è¿‡æ— æ³•åˆå§‹åŒ–çš„å·¥å…·ï¼Œç»§ç»­æ‰§è¡Œï¼š

    ```json è·³è¿‡å·¥å…· lines icon="forward"
    {
      "allowedTools": ["bash", "zhipin_reply_generator"],
      "contextStrategy": "skip"
    }
    ```

    å“åº”å¤´åŒ…å«è¢«è·³è¿‡çš„å·¥å…·ï¼š
    ```text å“åº”å¤´ icon="header"
    X-Tools-Skipped: zhipin_reply_generator
    ```

    **é€‚ç”¨åœºæ™¯**ï¼šå¯é€‰å·¥å…·ï¼Œéƒ¨åˆ†å¤±è´¥ä¸å½±å“ä¸»æµç¨‹
  </Tab>

  <Tab title="report">
    ä»…è¿”å›éªŒè¯æŠ¥å‘Šï¼Œä¸æ‰§è¡Œå¯¹è¯ï¼š

    ```json éªŒè¯æ¨¡å¼ lines icon="clipboard-check"
    {
      "allowedTools": ["bash", "zhipin_reply_generator"],
      "context": { ... },
      "contextStrategy": "report"
    }
    ```

    æˆ–ä½¿ç”¨ `validateOnly`ï¼š
    ```json validateOnly å‚æ•° icon="clipboard-check"
    {
      "validateOnly": true
    }
    ```

    **é€‚ç”¨åœºæ™¯**ï¼šé¢„æ£€å·¥å…·é…ç½®ï¼Œè°ƒè¯•ä¸Šä¸‹æ–‡é—®é¢˜
  </Tab>
</Tabs>

## æµå¼è¾“å‡ºä¸­çš„å·¥å…·äº‹ä»¶

ä½¿ç”¨ `stream: true` æ—¶ï¼Œå¯ä»¥å®æ—¶ç›‘æ§å·¥å…·è°ƒç”¨è¿‡ç¨‹ï¼š

```text å·¥å…·äº‹ä»¶ç¤ºä¾‹ lines icon="stream"
event: text
data: {"type":"text.delta","delta":"æˆ‘å°†"}

event: text
data: {"type":"text.delta","delta":"ä¸ºä½ ç”Ÿæˆä¸“ä¸šçš„æ‹›è˜å›å¤"}

event: tool
data: {"type":"tool.start","name":"zhipin_reply_generator","input":{"candidate_message":"ä½ ä»¬è–ªèµ„å¾…é‡æ€ä¹ˆæ ·ï¼Ÿ","brand":"èœ€åœ°æºå†’èœ"}}

event: tool
data: {"type":"tool.output","name":"zhipin_reply_generator","output":"ç”Ÿæˆä¸­..."}

event: tool
data: {"type":"tool.complete","name":"zhipin_reply_generator","state":"output-available","output":{"reply":"æ‚¨å¥½ï¼æˆ‘ä»¬çš„è–ªèµ„èŒƒå›´æ˜¯4000-6000å…ƒ..."}}

event: text
data: {"type":"text.delta","delta":"å·²ä¸ºæ‚¨ç”Ÿæˆä¸“ä¸šçš„æ‹›è˜å›å¤"}

event: done
data: {"type":"done"}
```

<Note>
  æµå¼æ¨¡å¼å…è®¸ä½ å®æ—¶çœ‹åˆ° AI çš„æ€è€ƒè¿‡ç¨‹å’Œå·¥å…·æ‰§è¡Œè¿›åº¦ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦å®æ—¶åé¦ˆçš„æ‹›è˜åœºæ™¯ã€‚
</Note>

## æ‰§è¡Œé™åˆ¶

ä¸ºäº†é˜²æ­¢æ— é™å¾ªç¯ï¼Œå·¥å…·è°ƒç”¨æœ‰ä»¥ä¸‹é™åˆ¶ï¼š

| é™åˆ¶é¡¹   | å€¼       | è¯´æ˜                         |
|---------|---------|------------------------------|
| æœ€å¤§æ­¥æ•° | 30      | åŒ…æ‹¬ AI ç”Ÿæˆå’Œå·¥å…·è°ƒç”¨çš„æ€»æ­¥æ•° |
| è¶…æ—¶     | 2 åˆ†é’Ÿ  | å•æ¬¡è¯·æ±‚çš„æœ€å¤§æ‰§è¡Œæ—¶é—´        |

<Warning>
  å¦‚æœè¾¾åˆ°æ­¥æ•°é™åˆ¶æˆ–è¶…æ—¶ï¼ŒAPI ä¼šè¿”å›å·²æ‰§è¡Œçš„éƒ¨åˆ†ç»“æœï¼Œå¹¶åœ¨å“åº”ä¸­æ ‡è®°æœªå®ŒæˆçŠ¶æ€ã€‚
</Warning>

## å®Œæ•´ç¤ºä¾‹

<Tabs>
  <Tab title="JavaScript">
    ```javascript JavaScript å®Œæ•´ç¤ºä¾‹ lines expandable icon="js"
    async function generateRecruitmentReply() {
      const response = await fetch("https://huajune.duliday.com/api/v1/chat", {
        method: "POST",
        headers: {
          Authorization: `Bearer ${apiKey}`,
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          model: "anthropic/claude-3-7-sonnet-20250219",
          messages: [
            {
              role: "user",
              content: "å€™é€‰äººé—®ï¼šä½ ä»¬å…¬å¸ç¦åˆ©å¾…é‡æ€ä¹ˆæ ·ï¼ŸåŒ…é£Ÿå®¿å—ï¼Ÿ"
            }
          ],
          allowedTools: ["zhipin_reply_generator"],
          context: {
            preferredBrand: "èœ€åœ°æºå†’èœ",
            configData: {
              city: "ä¸Šæµ·",
              brands: {
                "èœ€åœ°æºå†’èœ": {
                  templates: {
                    "benefits_inquiry": [
                      "äº”é™©ä¸€é‡‘ã€å‘˜å·¥é¤ã€äº¤é€šè¡¥è´´",
                      "æä¾›å‘˜å·¥å®¿èˆï¼ˆå•äººé—´ï¼‰"
                    ]
                  }
                }
              }
            },
            replyPrompts: {
              "benefits_inquiry": "è¯¦ç»†ä»‹ç»ç¦åˆ©å¾…é‡ï¼Œçªå‡ºä½å®¿ä¼˜åŠ¿"
            }
          },
          stream: false,
        }),
      });

      const data = await response.json();

      // æ‰“å°å®Œæ•´çš„å¯¹è¯å†å²
      console.log("å¯¹è¯å†å²:");
      data.data.messages.forEach((msg, idx) => {
        console.log(`\næ¶ˆæ¯ ${idx + 1} (${msg.role}):`);
        msg.parts.forEach(part => {
          if (part.type === 'text') {
            console.log(`  æ–‡æœ¬: ${part.text}`);
          } else if (part.type === 'dynamic-tool') {
            console.log(`  å·¥å…·è°ƒç”¨: ${part.toolName}`);
            console.log(`  è¾“å…¥:`, part.input);
            if (part.output) {
              console.log(`  è¾“å‡º:`, part.output);
            }
          }
        });
      });

      // æå–ç”Ÿæˆçš„æ‹›è˜å›å¤
      const toolMessage = data.data.messages.find(msg =>
        msg.parts.some(p => p.type === 'dynamic-tool')
      );
      const toolPart = toolMessage.parts.find(p => p.type === 'dynamic-tool');
      const reply = toolPart.output.reply;
      console.log("\nç”Ÿæˆçš„æ‹›è˜å›å¤:", reply);
    }

    generateRecruitmentReply();
    ```
  </Tab>

  <Tab title="Python">
    ```python Python å®Œæ•´ç¤ºä¾‹ lines expandable icon="python"
    import requests
    import json

    def generate_recruitment_reply():
        url = "https://huajune.duliday.com/api/v1/chat"
        headers = {
            "Authorization": f"Bearer {api_key}",
            "Content-Type": "application/json"
        }
        payload = {
            "model": "anthropic/claude-3-7-sonnet-20250219",
            "messages": [
                {
                    "role": "user",
                    "content": "å€™é€‰äººé—®ï¼šä½ ä»¬å…¬å¸ç¦åˆ©å¾…é‡æ€ä¹ˆæ ·ï¼ŸåŒ…é£Ÿå®¿å—ï¼Ÿ"
                }
            ],
            "allowedTools": ["zhipin_reply_generator"],
            "context": {
                "preferredBrand": "èœ€åœ°æºå†’èœ",
                "configData": {
                    "city": "ä¸Šæµ·",
                    "brands": {
                        "èœ€åœ°æºå†’èœ": {
                            "templates": {
                                "benefits_inquiry": [
                                    "äº”é™©ä¸€é‡‘ã€å‘˜å·¥é¤ã€äº¤é€šè¡¥è´´",
                                    "æä¾›å‘˜å·¥å®¿èˆï¼ˆå•äººé—´ï¼‰"
                                ]
                            }
                        }
                    }
                },
                "replyPrompts": {
                    "benefits_inquiry": "è¯¦ç»†ä»‹ç»ç¦åˆ©å¾…é‡ï¼Œçªå‡ºä½å®¿ä¼˜åŠ¿"
                }
            },
            "stream": False
        }

        response = requests.post(url, json=payload, headers=headers)
        data = response.json()

        # æ‰“å°å®Œæ•´çš„å¯¹è¯å†å²
        print("å¯¹è¯å†å²:")
        for idx, msg in enumerate(data['data']['messages']):
            print(f"\næ¶ˆæ¯ {idx + 1} ({msg['role']}):")
            for part in msg['parts']:
                if part['type'] == 'text':
                    print(f"  æ–‡æœ¬: {part['text']}")
                elif part['type'] == 'dynamic-tool':
                    print(f"  å·¥å…·è°ƒç”¨: {part['toolName']}")
                    print(f"  è¾“å…¥:", part['input'])
                    if 'output' in part:
                        print(f"  è¾“å‡º:", part['output'])

        # æå–ç”Ÿæˆçš„æ‹›è˜å›å¤
        tool_msg = next(msg for msg in data['data']['messages']
                        if any(p['type'] == 'dynamic-tool' for p in msg['parts']))
        tool_part = next(p for p in tool_msg['parts'] if p['type'] == 'dynamic-tool')
        reply = tool_part['output']['reply']
        print("\nç”Ÿæˆçš„æ‹›è˜å›å¤:", reply)

    generate_recruitment_reply()
    ```
  </Tab>

  <Tab title="cURL">
    ```bash cURL ç¤ºä¾‹ lines expandable icon="terminal"
    curl -X POST https://huajune.duliday.com/api/v1/chat \
      -H "Authorization: Bearer YOUR_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "model": "anthropic/claude-3-7-sonnet-20250219",
        "messages": [
          {
            "role": "user",
            "content": "å€™é€‰äººé—®ï¼šå·¥ä½œæ—¶é—´æ€ä¹ˆå®‰æ’ï¼Ÿ"
          }
        ],
        "allowedTools": ["zhipin_reply_generator"],
        "context": {
          "preferredBrand": "èœ€åœ°æºå†’èœ",
          "configData": {
            "brands": {
              "èœ€åœ°æºå†’èœ": {
                "templates": {
                  "schedule_inquiry": ["æ—©ç­8:00-17:00ï¼Œæ™šç­17:00-02:00ï¼Œè½®ç­åˆ¶"]
                }
              }
            }
          },
          "replyPrompts": {
            "schedule_inquiry": "è¯´æ˜å·¥ä½œæ—¶é—´å®‰æ’ï¼Œå¼ºè°ƒåˆç†æ€§"
          }
        },
        "stream": false
      }' | jq '.data.messages'
    ```
  </Tab>
</Tabs>

## å¸¸è§é—®é¢˜

<AccordionGroup>
  <Accordion title="å·¥å…·è°ƒç”¨éœ€è¦å¤šæ¬¡è¯·æ±‚å—ï¼Ÿ" icon="circle-question">
    **ä¸éœ€è¦**ã€‚èŠ±å·æ™ºèƒ½ä½“ API åœ¨æœåŠ¡ç«¯è‡ªåŠ¨å®Œæˆæ‰€æœ‰å·¥å…·è°ƒç”¨ï¼Œå•æ¬¡è¯·æ±‚å³å¯è·å¾—æœ€ç»ˆç»“æœã€‚

    **é”™è¯¯ç†è§£**ï¼š
    ```
    è¯·æ±‚ 1 â†’ è·å– tool-call â†’
    æ‰§è¡Œå·¥å…· â†’
    è¯·æ±‚ 2 (æäº¤ tool-result) â†’ æœ€ç»ˆç»“æœ
    ```

    **æ­£ç¡®æµç¨‹**ï¼š
    ```
    è¯·æ±‚ 1 â†’ æœåŠ¡ç«¯è‡ªåŠ¨å®Œæˆæ‰€æœ‰æ­¥éª¤ â†’ è¿”å›å®Œæ•´å†å²å’Œæœ€ç»ˆç»“æœ
    ```
  </Accordion>

  <Accordion title="å¦‚ä½•æŸ¥çœ‹å·¥å…·æ‰§è¡Œçš„ä¸­é—´è¿‡ç¨‹ï¼Ÿ" icon="circle-question">
    ä½¿ç”¨ `stream: true` å¯ä»¥å®æ—¶ç›‘æ§å·¥å…·è°ƒç”¨ï¼š

    ```javascript æµå¼ç›‘æ§ lines icon="stream"
    const response = await fetch(url, {
      body: JSON.stringify({ stream: true, ... })
    });

    const reader = response.body.getReader();
    // ç›‘å¬ event: tool äº‹ä»¶
    ```

    æˆ–è€…åœ¨éæµå¼æ¨¡å¼ä¸‹ï¼Œæ£€æŸ¥å“åº”ä¸­çš„ `messages` æ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰ä¸­é—´æ­¥éª¤ã€‚
  </Accordion>

  <Accordion title="å¦‚ä½•é™åˆ¶å·¥å…·çš„æ‰§è¡Œæ¬¡æ•°ï¼Ÿ" icon="circle-question">
    å½“å‰é»˜è®¤é™åˆ¶ä¸º 30 æ­¥ã€‚å¦‚æœéœ€è¦æ›´ä¸¥æ ¼çš„æ§åˆ¶ï¼Œå¯ä»¥ï¼š

    1. ä½¿ç”¨æ›´æ˜ç¡®çš„æç¤ºè¯ï¼Œå‡å°‘ä¸å¿…è¦çš„å·¥å…·è°ƒç”¨
    2. è”ç³»æŠ€æœ¯æ”¯æŒè°ƒæ•´é™åˆ¶
    3. åœ¨ `context` ä¸­æä¾›æ›´å®Œæ•´çš„ä¿¡æ¯ï¼Œå‡å°‘æ¢ç´¢æ€§è°ƒç”¨
  </Accordion>

  <Accordion title="ä¸ºä»€ä¹ˆæˆ‘çš„å·¥å…·æ²¡æœ‰è¢«è°ƒç”¨ï¼Ÿ" icon="circle-question">
    å¯èƒ½çš„åŸå› ï¼š

    1. **å·¥å…·æœªåœ¨ allowedTools ä¸­**
       ```json æ­£ç¡®é…ç½® icon="check"
       {
         "allowedTools": ["zhipin_reply_generator"]
       }
       ```

    2. **ç¼ºå°‘å¿…éœ€çš„ä¸Šä¸‹æ–‡**
       ```json å®Œæ•´é…ç½®ç¤ºä¾‹ lines icon="check"
       {
         "allowedTools": ["zhipin_reply_generator"],
         "context": {
           "preferredBrand": "èœ€åœ°æºå†’èœ",
           "configData": { ... },    // â† å¿…éœ€
           "replyPrompts": { ... }   // â† å¿…éœ€
         }
       }
       ```

       - ä½¿ç”¨ `validateOnly: true` é¢„æ£€é…ç½®
       - æ£€æŸ¥ `GET /api/v1/tools` çš„ `requiredContext`

    3. **AI åˆ¤æ–­ä¸éœ€è¦è°ƒç”¨**
       - å°è¯•æ›´æ˜ç¡®çš„æç¤ºè¯
       - ç¡®è®¤ä»»åŠ¡ç¡®å®éœ€è¦è¯¥å·¥å…·

    4. **bash å·¥å…·ç¼ºå°‘æ²™ç›’ç¯å¢ƒ**
       - bash å·¥å…·éœ€è¦ `context.sandboxId`
       - å»ºè®®ä½¿ç”¨ä¸šåŠ¡å·¥å…·è€Œé bash
  </Accordion>

  <Accordion title="å¦‚ä½•æŸ¥çœ‹å·¥å…·éœ€è¦å“ªäº›ä¸Šä¸‹æ–‡ï¼Ÿ" icon="circle-question">
    ä½¿ç”¨ `GET /api/v1/tools` ç«¯ç‚¹æŸ¥çœ‹æ¯ä¸ªå·¥å…·çš„ `requiredContext`ï¼š

    ```bash æŸ¥çœ‹å·¥å…·è¦æ±‚ icon="terminal"
    curl -X GET https://huajune.duliday.com/api/v1/tools \
      -H "Authorization: Bearer YOUR_API_KEY"
    ```

    æˆ–ä½¿ç”¨ `validateOnly: true` é¢„æ£€é…ç½®ã€‚
  </Accordion>
</AccordionGroup>

## ä¸‹ä¸€æ­¥

<CardGroup cols={2}>
  <Card
    title="æ¶ˆæ¯æ ¼å¼"
    icon="message"
    href="/concepts/messages"
  >
    äº†è§£ tool-call å’Œ tool-result çš„æ¶ˆæ¯ç»“æ„
  </Card>

  <Card
    title="å·¥å…·ç³»ç»Ÿ"
    icon="book"
    href="/concepts/tools"
  >
    æ·±å…¥äº†è§£å·¥å…·ç³»ç»Ÿå’Œå·¥å…·å®šä¹‰
  </Card>

  <Card
    title="ä¸Šä¸‹æ–‡ç®¡ç†"
    icon="gear"
    href="/concepts/context"
  >
    ç†è§£å·¥å…·ä¸Šä¸‹æ–‡é…ç½®å’ŒéªŒè¯
  </Card>

  <Card
    title="æµå¼è¾“å‡º"
    icon="stream"
    href="/features/streaming"
  >
    å­¦ä¹ å¦‚ä½•ä½¿ç”¨æµå¼è¾“å‡ºç›‘æ§å·¥å…·æ‰§è¡Œ
  </Card>
</CardGroup>
