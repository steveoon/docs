---
title: "文本对话"
description: "使用花卷智能体进行基础文本对话"
---

## 基础对话

最简单的 API 调用，实现纯文本对话：

```bash
curl -X POST https://huajune.duliday.com/api/v1/chat \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "anthropic/claude-3-7-sonnet-20250219",
    "messages": [
      {
        "role": "user",
        "content": "你好，请介绍一下你自己"
      }
    ],
    "stream": false
  }'
```

## 多轮对话

通过传递完整的对话历史实现上下文连贯的多轮对话：

```javascript
const messages = [
  { role: "user", content: "1+1等于几？" },
  { role: "assistant", content: "1+1等于2" },
  { role: "user", content: "那再加3呢？" },
];

const response = await fetch("https://huajune.duliday.com/api/v1/chat", {
  method: "POST",
  headers: {
    Authorization: `Bearer ${apiKey}`,
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    model: "anthropic/claude-3-7-sonnet-20250219",
    messages: messages,
    stream: false,
  }),
});
```

## 自定义系统提示词

通过 `systemPrompt` 自定义 AI 的角色和行为：

```json
{
  "model": "anthropic/claude-3-7-sonnet-20250219",
  "systemPrompt": "你是一个专业的Python编程导师，擅长用简单易懂的语言解释复杂的编程概念。回复时请使用中文，并提供代码示例。",
  "messages": [
    {
      "role": "user",
      "content": "什么是装饰器？"
    }
  ],
  "stream": false
}
```

## 流式 vs 非流式

### 非流式输出

一次性返回完整响应，适合后台处理场景：

```json
{
  "stream": false // 或省略此字段，默认为 false
}
```

响应格式：

```json
{
  "success": true,
  "data": {
    "messages": [
      {
        "id": "msg_abc123",
        "role": "assistant",
        "parts": [
          {
            "type": "text",
            "text": "完整的回复内容..."
          }
        ]
      }
    ],
    "usage": {
      "inputTokens": 15,
      "outputTokens": 45,
      "totalTokens": 60
    }
  }
}
```

### 流式输出

实时返回生成的内容，提供更好的用户体验：

```json
{
  "stream": true
}
```

详见 [流式输出功能](/features/streaming)

## 完整示例

<CodeGroup>

```javascript JavaScript
async function chat(message) {
  const response = await fetch("https://huajune.duliday.com/api/v1/chat", {
    method: "POST",
    headers: {
      Authorization: `Bearer ${process.env.HUAJUNE_API_KEY}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      model: "anthropic/claude-3-7-sonnet-20250219",
      systemPrompt: "你是一个友好的AI助手",
      messages: [{ role: "user", content: message }],
      stream: false,
    }),
  });

  const data = await response.json();
  return data.data.messages[0].parts[0].text;
}

// 使用
const reply = await chat("你好！");
console.log(reply);
```

```python Python
import os
import requests

def chat(message):
    url = "https://huajune.duliday.com/api/v1/chat"
    headers = {
        "Authorization": f"Bearer {os.getenv('HUAJUNE_API_KEY')}",
        "Content-Type": "application/json"
    }
    payload = {
        "model": "anthropic/claude-3-7-sonnet-20250219",
        "systemPrompt": "你是一个友好的AI助手",
        "messages": [
            {"role": "user", "content": message}
        ],
        "stream": False
    }

    response = requests.post(url, json=payload, headers=headers)
    data = response.json()
    return data['data']['messages'][0]['parts'][0]['text']

# 使用
reply = chat('你好！')
print(reply)
```

</CodeGroup>

## 下一步

<CardGroup cols={2}>
  <Card
    title="流式输出"
    icon="stream"
    href="/features/streaming"
  >
    实现打字机效果的实时对话
  </Card>

  <Card
    title="工具调用"
    icon="wrench"
    href="/features/tool-calling"
  >
    让 AI 调用工具完成复杂任务
  </Card>
</CardGroup>
